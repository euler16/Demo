
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>LipNext</title>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"/>
<script src="opencv.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
	
	
</head>
<body>
  <nav class="navbar navbar-expand-sm bg-light navbar-light">
    <a class="navbar-brand" href="#"><h1>LipNext</h1></a>
  </nav>
  
  <div class="container-fluid"> 
    <blockquote class="blockquote text-justify" style="margin:30px;">
      <p> LipNext is a simple tool that uses CNN to read lip movements and classify the words into a set of 500 target words. It uses a model which is compressable to as low as 6MB in size. The table shows the top 5 predictions. </p>
      <footer class="blockquote-footer">Nilay Shrivastava â€¢ Astitwa Saxena</footer>
    </blockquote>
  </div>

  <video hidden id="videoInput"></video>
  <canvas width="1280" height="720" id="canvasDisplay" ></canvas>
  <canvas id="canvasFrame" ></canvas>

  <script type="text/javascript">
    cv['onRuntimeInitialized']=()=>
    {
      let video = document.getElementById("videoInput"); // video is the id of video tag
      navigator.mediaDevices.getUserMedia({ video: { width: 1280, height: 720 }, audio: false })
          .then(function(stream) {
              video.srcObject = stream;
              console.log(stream)
              video.play();
          })
          .catch(function(err) {
              console.log("An error occurred! " + err);
          });

      let canvasFrame = document.getElementById("canvasFrame"); // canvasFrame is the id of <canvas>
      let context = canvasFrame.getContext("2d");
      let canvasDisplay=document.getElementById("canvasDisplay");
      let contextDisplay=canvasDisplay.getContext("2d");

      let src = new cv.Mat(96, 96, cv.CV_8UC4);
      const FPS = 30;
      function processVideo() {
          let begin = Date.now();
          context.drawImage(video, 650, 400, 180, 180, 0, 0,96, 96);
          src.data.set(context.getImageData(0, 0, 96, 96).data);
          
          contextDisplay.drawImage(video,0,0,1280,720,0,0,1280,720)
          contextDisplay.rect(650,400,180,180)
          contextDisplay.strokeStyle = "#FF0000";
          contextDisplay.lineWidth = 10;
          contextDisplay.stroke()
          // schedule next one.
          let delay = 1000/FPS - (Date.now() - begin);
          setTimeout(processVideo, delay);
      }
      // schedule first one.
      setTimeout(processVideo, 0);
    }
  </script>
</body>


</html>
